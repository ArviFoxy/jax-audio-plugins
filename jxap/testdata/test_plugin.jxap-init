#loc = loc(unknown)
#loc11 = loc("buffers['input']")
#loc12 = loc("sample_rate")
module @jit__init_fn attributes {jax.uses_shape_polymorphism = true, mhlo.num_partitions = 1 : i32, mhlo.num_replicas = 1 : i32} {
  func.func public @main(%arg0: tensor<i32> {jax.global_constant = "_platform_index"} loc(unknown), %arg1: tensor<?xf32> loc(unknown), %arg2: tensor<f32> loc(unknown)) -> (tensor<f32> {jax.result_info = "result[0]"}) {
    %c = stablehlo.constant dense<0> : tensor<i32> loc(#loc)
    %c_0 = stablehlo.constant dense<-1> : tensor<i32> loc(#loc)
    %c_1 = stablehlo.constant dense<1> : tensor<i32> loc(#loc)
    %0 = stablehlo.get_dimension_size %arg1, dim = 0 : (tensor<?xf32>) -> tensor<i32> loc(#loc32)
    %1 = stablehlo.compare  GE, %0, %c_1,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1> loc(#loc33)
    stablehlo.custom_call @shape_assertion(%1, %0) {api_version = 2 : i32, error_message = "Input shapes do not match the polymorphic shapes specification. Expected value >= 1 for dimension variable 'BufferSize'. Using the following polymorphic shapes specifications: args[0]['input'].shape = (BufferSize,). Obtained dimension variables: 'BufferSize' = {0} from specification 'BufferSize' for dimension args[0]['input'].shape[0] (= {0}), . Please see https://docs.jax.dev/en/latest/export/shape_poly.html#shape-assertion-errors for more details.", has_side_effect = true} : (tensor<i1>, tensor<i32>) -> () loc(#loc34)
    %2 = stablehlo.convert %0 : tensor<i32> loc(#loc35)
    %3 = stablehlo.add %2, %c_0 : tensor<i32> loc(#loc36)
    %4 = stablehlo.compare  GE, %3, %c,  SIGNED : (tensor<i32>, tensor<i32>) -> tensor<i1> loc(#loc33)
    %5 = stablehlo.convert %0 : tensor<i32> loc(#loc35)
    %6 = stablehlo.add %5, %c_0 : tensor<i32> loc(#loc36)
    stablehlo.custom_call @shape_assertion(%4, %6, %0) {api_version = 2 : i32, error_message = "Input shapes do not match the symbolic shape constraint BufferSize >= 1. Expected 'BufferSize - 1' to be greater or equal to 0, but found {0}.  Using the following polymorphic shapes specifications: args[0]['input'].shape = (BufferSize,). Obtained dimension variables: 'BufferSize' = {1} from specification 'BufferSize' for dimension args[0]['input'].shape[0] (= {1}), . Please see https://docs.jax.dev/en/latest/export/shape_poly.html#shape-assertion-errors for more details.", has_side_effect = true} : (tensor<i1>, tensor<i32>, tensor<i32>) -> () loc(#loc34)
    %7 = call @_wrapped_jax_export_main(%arg0, %0, %arg1, %arg2) : (tensor<i32>, tensor<i32>, tensor<?xf32>, tensor<f32>) -> tensor<f32> loc(#loc)
    return %7 : tensor<f32> loc(#loc)
  } loc(#loc)
  func.func private @_wrapped_jax_export_main(%arg0: tensor<i32> {jax.global_constant = "_platform_index"} loc(unknown), %arg1: tensor<i32> {jax.global_constant = "BufferSize"} loc(unknown), %arg2: tensor<?xf32> loc("buffers['input']"), %arg3: tensor<f32> loc("sample_rate")) -> (tensor<f32> {jax.result_info = "result[0]"}) {
    %cst = stablehlo.constant dense<0.000000e+00> : tensor<f32> loc(#loc)
    return %cst : tensor<f32> loc(#loc)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/workspaces/jxap/python/jax_audio_plugins/export.py":87:23 to 88:79)
#loc2 = loc("/workspaces/jxap/python/jax_audio_plugins/export_test.py":47:8 to :49)
#loc3 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/_pretty_print_reporter.py":84:13 to :30)
#loc4 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/absltest.py":2793:19 to :56)
#loc5 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/absltest.py":2829:35 to 2831:3)
#loc6 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/absltest.py":2373:6 to :34)
#loc7 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/app.py":261:13 to :23)
#loc8 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/app.py":316:6 to :27)
#loc9 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/absltest.py":2375:4 to :31)
#loc10 = loc("/workspaces/.venv/lib/python3.11/site-packages/absl/testing/absltest.py":2269:2 to :38)
#loc13 = loc("export_plugin"(#loc1))
#loc14 = loc("ExportingTest.test_export_plugin"(#loc2))
#loc15 = loc("TextTestRunner.run"(#loc3))
#loc16 = loc("_run_and_get_tests_result"(#loc4))
#loc17 = loc("run_tests"(#loc5))
#loc18 = loc("_run_in_app.<locals>.main_function"(#loc6))
#loc19 = loc("_run_main"(#loc7))
#loc20 = loc("run"(#loc8))
#loc21 = loc("_run_in_app"(#loc9))
#loc22 = loc("main"(#loc10))
#loc23 = loc(callsite(#loc21 at #loc22))
#loc24 = loc(callsite(#loc20 at #loc23))
#loc25 = loc(callsite(#loc19 at #loc24))
#loc26 = loc(callsite(#loc18 at #loc25))
#loc27 = loc(callsite(#loc17 at #loc26))
#loc28 = loc(callsite(#loc16 at #loc27))
#loc29 = loc(callsite(#loc15 at #loc28))
#loc30 = loc(callsite(#loc14 at #loc29))
#loc31 = loc(callsite(#loc13 at #loc30))
#loc32 = loc("/dimension_size"(#loc31))
#loc33 = loc("/ge"(#loc31))
#loc34 = loc("/shape_assertion"(#loc31))
#loc35 = loc("/convert_element_type"(#loc31))
#loc36 = loc("/add"(#loc31))
